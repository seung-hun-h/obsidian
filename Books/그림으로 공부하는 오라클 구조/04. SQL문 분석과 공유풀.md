### SQL문
- SQL은 일반적인 절차적인 프로그래밍 언어와는 다르게 선언형이다
	- 선언형 언어는 구체적인 동작과정이 외부로 드러나지 않는다
- 선언형이라 하더라도 결국 SQL을 실행하는 내부 동작이 있다
- `옵티마이저`는 SQL문을 분석하여 실행 계획을 만들어준다
### 서버 프로세스와 분석
- 분석:  SQL을 분해하고, 어떻게 처리할 지 결정하는 것
- 오라클은 `비용기반` 분석 알고리즘을 사용한다
- 비용기반: SQL을 처리하는데 필요한 I/O 횟수나 시간 자원등을 고려하는 것
- 비용을 계산하기 위해서는 기초 데이터가 필요한데 `통계 정보`라 한다
### 최적의 실행 계획
- 옵티마이저는 여러 실행 계획 중 최저 비용을 가진 실행 계획을 채택한다
- 가능한 실행 계획의 모든 비용을 계산해야 한다
- 접근하는 테이블의 개수가 많아지면 실행 계획도 많아져 옵티마이저가 최적의 실행계획을 선택하기 어려워진다

>[!note] 어댑티브 쿼리
>오라클은 ’사전에‘ 수집된 통계 정보를 기반으로 실행 계획의 비용을 산출한다
>사전에 통계 정보를 수집하는 이유는 SQL 실행시 부하를 줄이기 위함이다. 하지만 통계 정보와 실제 데이터의 괴리가 커진 경우에는 최적의 실행 계획이 채택되지 않을 수 있다
>이를 위해 12c 부터 어댑티브 쿼리 최적화 기능이 도입되었다
>어댑티브 쿼리 최적화 기능을 통해 SQL 실행 시점에 통계 정보를 동적으로 수집한 후 최종적으로 실행 계획을 선택할 수 있게 되었다. 다만 SQL의 실행 속도가 느러지는 단점이 있다

### 공유 풀
- 매번 실행 계획을 생성하고 최적의 실행 계획을 채택하는 과정은 비용이 많이 든다
- 공유 풀은 실행 계획을 재사용하여 분석 작업을 줄이기 위해 존재한다
- 공유 풀은 프로세스간 공유되어야 하므로 공유 메모리 공간에 존재한다
- 공유 풀의 구조
	- 딕셔너리 캐시: 통계 정보의 캐시등 SQL 실행에 필요한 메타 정보
	- 라이브러리 캐시: 실행 계획등의 SQL 정보
	- 그 외
- 오라클은 SQL문을 해싱하여 고유 ID를 생성한다

#### 분석
- 분석에는 소프트 파스와 하드 파스가 있다
- 소프트 파스: 공유 풀에서 해시된 실행 계획을 찾아 실행하는 경우
- 하드 파스: 공유 풀에서 해시된 실행 계획을 발견하지 못하여 실행 계획을 생성하는 경우





